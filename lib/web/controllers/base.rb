module Web
  module Controllers
    # Base controller for all routes.
    class Base < Sinatra::Base
      set :root, File.dirname(__FILE__)
      set :sessions, true

      register Sinatra::ConfigFile
      register Sinatra::Wpxf::CsrfProtection

      use Rack::PostBodyContentTypeParser

      config_file '../../../config/web.yml'

      configure :production, :development do
        enable :logging
      end

      configure :production, :test do
        error do
          json error: true
        end
      end

      not_found do
        json error: true, not_found: true
      end
    end
  end
end
