module Web
  module Controllers
    # Controller to handle all routes relating to payloads.
    class Payloads < Base
      helpers Web::Helpers::OptionsHelper

      get '/' do
        payloads = []

        Wpxf::Payloads.payload_list.each do |p|
          payload = p[:class].new
          payloads.push(
            name: p[:name],
            desc: payload.description,
            options: options_hash(payload.options)
          )
        end

        json payloads
      end
    end
  end
end
