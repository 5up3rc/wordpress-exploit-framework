import { Component, OnInit }              from '@angular/core';
import { ActivatedRoute, Params, Router } from '@angular/router';

import { Session }             from '../shared/session'
import { SessionService }      from '../shared/session.service'
import { DataTableComponent }  from '../../shared'

import * as moment from 'moment';

@Component({
  selector: 'session-list',
  moduleId: module.id,
  templateUrl: 'session-list.component.html'
})

export class SessionListComponent implements OnInit {
  private sessions: Session[];

  constructor(
    private sessionService: SessionService,
    private router: Router) {
  }

  ngOnInit(): void {
    this.sessionService
        .getSessions()
        .then(sessions => this.bind(sessions));
  }

  bind(sessions): void {
    this.sessions = sessions.map(function(session) {
      session.created_at = moment(session.created_at, 'YYYY-MM-DD HH:mm:ss', false).format('YYYY-MM-DD, HH:mm');
      return session;
    });
  }

  loadSession(session: any): void {
    this.router.navigate(['session', session.id]);
  }
}
